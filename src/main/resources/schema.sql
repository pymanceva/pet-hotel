
DROP TABLE IF EXISTS users CASCADE;
DROP TABLE IF EXISTS pets CASCADE;
DROP TABLE IF EXISTS rooms;
DROP TABLE IF EXISTS comments;

CREATE TABLE IF NOT EXISTS users
(
    id    BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    name  VARCHAR(255)                            NOT NULL,
    email VARCHAR(254)                            NOT NULL,
    role  VARCHAR(16)                             NOT NULL,
    CONSTRAINT pk_user PRIMARY KEY (id),
    CONSTRAINT UQ_USER_EMAIL UNIQUE (email)
);

INSERT INTO users (name, email, role) values ('boss', 'boss@mail.ru', 'ROLE_BOSS');

CREATE TABLE IF NOT EXISTS pets
(
    id_pet                 BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    type_pet           VARCHAR(250)                            NOT NULL,
    breed_pet          VARCHAR(250)                            NOT NULL,
    sex_pet            VARCHAR(13)                             NOT NULL,
    age_pet            INTEGER                                 NOT NULL,
    weight_pet         INTEGER                                 NOT NULL,
    diet_pet           VARCHAR(21)                             NOT NULL,
    medication_pet     BOOLEAN                                 NOT NULL,
    contact_pet        BOOLEAN                                 NOT NULL,
    photographed_pet   BOOLEAN                                 NOT NULL,
    CONSTRAINT pk_pet PRIMARY KEY (id_pet)
);

CREATE TABLE IF NOT EXISTS rooms
(
    id        BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    number    VARCHAR(100)                            NOT NULL,
    price     REAL,
    size      REAL,
    type      VARCHAR(16)                             NOT NULL,
    available BOOLEAN DEFAULT TRUE,
    CONSTRAINT pk_room PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS comments
(
    id_comment        BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    text_comment      VARCHAR(1024)                           NOT NULL,
    author_id_comment BIGINT                                  NOT NULL,
    pet_id_comment    BIGINT                                  NOT NULL,
    created_comment   TIMESTAMP WITHOUT TIME ZONE DEFAULT NOW(),
    CONSTRAINT pk_comment PRIMARY KEY (id_comment),
    CONSTRAINT fk_comments_to_users FOREIGN KEY (author_id_comment) REFERENCES users (id) ON DELETE CASCADE,
    CONSTRAINT fk_comments_to_pets FOREIGN KEY (pet_id_comment) REFERENCES pets (id_pet) ON DELETE CASCADE
);


